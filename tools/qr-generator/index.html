<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Generator - Vibe Tools</title>
    
    <!-- Tailwind CSS & DaisyUI -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.7.2/dist/full.min.css" rel="stylesheet" />
    
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- QR Code Library -->
    <script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs/qrcode.min.js"></script>
    
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card-gradient {
            background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.9) 100%);
            backdrop-filter: blur(10px);
        }
        
        .qr-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .input-group {
            position: relative;
            margin-bottom: 1rem;
        }
        
        .input-group label {
            position: absolute;
            top: -10px;
            left: 12px;
            background: white;
            padding: 0 6px;
            font-size: 0.875rem;
            font-weight: 500;
            color: #667eea;
            z-index: 10;
        }
        
        .color-input {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .preset-type {
            transition: all 0.3s ease;
        }
        
        .preset-type:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .preset-type.active {
            background: #667eea;
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .download-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s ease;
        }
        
        .download-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        #qrPreview {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
        }
        
        #qrPreview canvas,
        #qrPreview img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .toast-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            padding: 12px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        
        .toast-notification.show {
            transform: translateX(0);
        }
        
        .toast-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .toast-error {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }
        
        .wifi-form-group {
            display: none;
        }
        
        .wifi-form-group.active {
            display: block;
        }
        
        .feature-card {
            transition: all 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
    </style>
</head>

<body class="min-h-screen gradient-bg" x-data="qrGenerator()">
    
    <!-- Header -->
    <header class="bg-white/80 backdrop-blur-md shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <a href="../../index.html" class="btn btn-ghost btn-sm">
                        <i class="fas fa-arrow-left mr-2"></i>
                        <span class="hidden md:inline">Back to Hub</span>
                    </a>
                    <div class="flex items-center space-x-2">
                        <div class="text-2xl md:text-3xl">ðŸ“±</div>
                        <div>
                            <h1 class="text-lg md:text-2xl font-bold text-gray-800">
                                QR Code Generator
                            </h1>
                            <p class="text-xs md:text-sm text-gray-600 hidden sm:block">Generate QR codes for text, URLs, WiFi, and more</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            
            <!-- Left Panel - Configuration -->
            <div class="space-y-6">
                
                <!-- QR Type Selection -->
                <div class="card-gradient rounded-xl p-6 shadow-xl">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-layer-group mr-2 text-purple-600"></i>
                        QR Code Type
                    </h3>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                        <template x-for="type in qrTypes" :key="type.id">
                            <div 
                                class="preset-type p-3 bg-white rounded-lg border-2 cursor-pointer text-center"
                                :class="{ 'active': selectedType === type.id, 'border-purple-200': selectedType !== type.id, 'border-purple-500': selectedType === type.id }"
                                @click="selectType(type.id)"
                            >
                                <div class="text-2xl mb-1" x-text="type.icon"></div>
                                <div class="text-xs font-medium" x-text="type.name"></div>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- Content Input -->
                <div class="card-gradient rounded-xl p-6 shadow-xl">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-edit mr-2 text-purple-600"></i>
                        Content
                    </h3>
                    
                    <!-- Text/URL Input -->
                    <div x-show="selectedType === 'text' || selectedType === 'url'">
                        <div class="input-group">
                            <label for="textContent" x-text="selectedType === 'url' ? 'Enter URL' : 'Enter Text'"></label>
                            <textarea 
                                id="textContent"
                                class="w-full p-4 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors resize-none"
                                rows="4"
                                :placeholder="selectedType === 'url' ? 'https://example.com' : 'Enter your text here...'"
                                x-model="content.text"
                                @input="generateQR()"
                            ></textarea>
                        </div>
                    </div>
                    
                    <!-- Email Input -->
                    <div x-show="selectedType === 'email'">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="input-group">
                                <label for="emailAddress">Email Address</label>
                                <input 
                                    id="emailAddress"
                                    type="email" 
                                    class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                                    placeholder="example@email.com"
                                    x-model="content.email"
                                    @input="generateQR()"
                                >
                            </div>
                            <div class="input-group">
                                <label for="emailSubject">Subject (Optional)</label>
                                <input 
                                    id="emailSubject"
                                    type="text" 
                                    class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                                    placeholder="Email subject"
                                    x-model="content.subject"
                                    @input="generateQR()"
                                >
                            </div>
                        </div>
                        <div class="input-group mt-4">
                            <label for="emailBody">Message (Optional)</label>
                            <textarea 
                                id="emailBody"
                                class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors resize-none"
                                rows="3"
                                placeholder="Email message..."
                                x-model="content.body"
                                @input="generateQR()"
                            ></textarea>
                        </div>
                    </div>
                    
                    <!-- Phone Input -->
                    <div x-show="selectedType === 'phone'">
                        <div class="input-group">
                            <label for="phoneNumber">Phone Number</label>
                            <input 
                                id="phoneNumber"
                                type="tel" 
                                class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                                placeholder="+1234567890"
                                x-model="content.phone"
                                @input="generateQR()"
                            >
                        </div>
                    </div>
                    
                    <!-- SMS Input -->
                    <div x-show="selectedType === 'sms'">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="input-group">
                                <label for="smsNumber">Phone Number</label>
                                <input 
                                    id="smsNumber"
                                    type="tel" 
                                    class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                                    placeholder="+1234567890"
                                    x-model="content.smsNumber"
                                    @input="generateQR()"
                                >
                            </div>
                        </div>
                        <div class="input-group mt-4">
                            <label for="smsMessage">Message</label>
                            <textarea 
                                id="smsMessage"
                                class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors resize-none"
                                rows="3"
                                placeholder="SMS message..."
                                x-model="content.smsMessage"
                                @input="generateQR()"
                            ></textarea>
                        </div>
                    </div>
                    
                    <!-- WiFi Input -->
                    <div x-show="selectedType === 'wifi'">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="input-group">
                                <label for="wifiSSID">Network Name (SSID)</label>
                                <input 
                                    id="wifiSSID"
                                    type="text" 
                                    class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                                    placeholder="WiFi Network Name"
                                    x-model="content.wifi.ssid"
                                    @input="generateQR()"
                                >
                            </div>
                            <div class="input-group">
                                <label for="wifiSecurity">Security Type</label>
                                <select 
                                    id="wifiSecurity"
                                    class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                                    x-model="content.wifi.encryption"
                                    @change="generateQR()"
                                >
                                    <option value="WPA">WPA/WPA2</option>
                                    <option value="WEP">WEP</option>
                                    <option value="nopass">None (Open)</option>
                                </select>
                            </div>
                        </div>
                        <div class="input-group mt-4" x-show="content.wifi.encryption !== 'nopass'">
                            <label for="wifiPassword">Password</label>
                            <div class="relative">
                                <input 
                                    id="wifiPassword"
                                    :type="showWifiPassword ? 'text' : 'password'"
                                    class="w-full p-3 pr-12 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                                    placeholder="WiFi password"
                                    x-model="content.wifi.password"
                                    @input="generateQR()"
                                >
                                <button 
                                    type="button"
                                    class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-purple-600"
                                    @click="showWifiPassword = !showWifiPassword"
                                >
                                    <i :class="showWifiPassword ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
                                </button>
                            </div>
                        </div>
                        <div class="input-group mt-4">
                            <label class="flex items-center space-x-2">
                                <input 
                                    type="checkbox"
                                    class="checkbox checkbox-primary checkbox-sm"
                                    x-model="content.wifi.hidden"
                                    @change="generateQR()"
                                >
                                <span class="text-sm">Hidden Network</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- vCard Input -->
                    <div x-show="selectedType === 'vcard'">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="input-group">
                                <label for="vcardFirstName">First Name</label>
                                <input 
                                    id="vcardFirstName"
                                    type="text" 
                                    class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                                    placeholder="John"
                                    x-model="content.vcard.firstName"
                                    @input="generateQR()"
                                >
                            </div>
                            <div class="input-group">
                                <label for="vcardLastName">Last Name</label>
                                <input 
                                    id="vcardLastName"
                                    type="text" 
                                    class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                                    placeholder="Doe"
                                    x-model="content.vcard.lastName"
                                    @input="generateQR()"
                                >
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                            <div class="input-group">
                                <label for="vcardOrg">Organization</label>
                                <input 
                                    id="vcardOrg"
                                    type="text" 
                                    class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                                    placeholder="Company Name"
                                    x-model="content.vcard.organization"
                                    @input="generateQR()"
                                >
                            </div>
                            <div class="input-group">
                                <label for="vcardTitle">Job Title</label>
                                <input 
                                    id="vcardTitle"
                                    type="text" 
                                    class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                                    placeholder="Software Developer"
                                    x-model="content.vcard.title"
                                    @input="generateQR()"
                                >
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                            <div class="input-group">
                                <label for="vcardPhone">Phone</label>
                                <input 
                                    id="vcardPhone"
                                    type="tel" 
                                    class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                                    placeholder="+1234567890"
                                    x-model="content.vcard.phone"
                                    @input="generateQR()"
                                >
                            </div>
                            <div class="input-group">
                                <label for="vcardEmail">Email</label>
                                <input 
                                    id="vcardEmail"
                                    type="email" 
                                    class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                                    placeholder="john@example.com"
                                    x-model="content.vcard.email"
                                    @input="generateQR()"
                                >
                            </div>
                        </div>
                        <div class="input-group mt-4">
                            <label for="vcardWebsite">Website</label>
                            <input 
                                id="vcardWebsite"
                                type="url" 
                                class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                                placeholder="https://example.com"
                                x-model="content.vcard.website"
                                @input="generateQR()"
                            >
                        </div>
                    </div>
                </div>

                <!-- Customization Options -->
                <div class="card-gradient rounded-xl p-6 shadow-xl">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-sliders-h mr-2 text-purple-600"></i>
                        Customization
                    </h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Size -->
                        <div>
                            <label for="qrSize" class="block text-sm font-medium text-gray-700 mb-2">
                                Size: <span x-text="size + 'px'"></span>
                            </label>
                            <input 
                                id="qrSize"
                                type="range" 
                                min="128" 
                                max="512" 
                                step="32"
                                class="range range-primary"
                                x-model="size"
                                @input="generateQR()"
                            >
                            <div class="w-full flex justify-between text-xs text-gray-500 mt-1">
                                <span>128px</span>
                                <span>320px</span>
                                <span>512px</span>
                            </div>
                        </div>
                        
                        <!-- Error Correction -->
                        <div>
                            <label for="errorCorrection" class="block text-sm font-medium text-gray-700 mb-2">Error Correction</label>
                            <select 
                                id="errorCorrection"
                                class="w-full p-2 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                                x-model="errorCorrection"
                                @change="generateQR()"
                            >
                                <option value="L">Low (7%)</option>
                                <option value="M">Medium (15%)</option>
                                <option value="Q">Quartile (25%)</option>
                                <option value="H">High (30%)</option>
                            </select>
                        </div>
                        
                        <!-- Colors -->
                        <div>
                            <label for="foregroundColor" class="block text-sm font-medium text-gray-700 mb-2">Foreground Color</label>
                            <div class="flex items-center space-x-3">
                                <input 
                                    id="foregroundColor"
                                    type="color" 
                                    class="color-input"
                                    x-model="foregroundColor"
                                    @change="generateQR()"
                                >
                                <input 
                                    type="text" 
                                    class="flex-1 p-2 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors font-mono text-sm"
                                    x-model="foregroundColor"
                                    @input="generateQR()"
                                >
                            </div>
                        </div>
                        
                        <div>
                            <label for="backgroundColor" class="block text-sm font-medium text-gray-700 mb-2">Background Color</label>
                            <div class="flex items-center space-x-3">
                                <input 
                                    id="backgroundColor"
                                    type="color" 
                                    class="color-input"
                                    x-model="backgroundColor"
                                    @change="generateQR()"
                                >
                                <input 
                                    type="text" 
                                    class="flex-1 p-2 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors font-mono text-sm"
                                    x-model="backgroundColor"
                                    @input="generateQR()"
                                >
                            </div>
                        </div>
                    </div>
                    
                    <!-- Color Presets -->
                    <div class="mt-4">
                        <span class="block text-sm font-medium text-gray-700 mb-2">Color Presets</span>
                        <div class="flex flex-wrap gap-2">
                            <template x-for="preset in colorPresets" :key="preset.name">
                                <button 
                                    class="px-3 py-2 rounded-lg text-xs font-medium border-2 transition-all"
                                    :style="`background: ${preset.bg}; color: ${preset.fg}; border-color: ${preset.fg}20`"
                                    @click="applyColorPreset(preset)"
                                    x-text="preset.name"
                                ></button>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Right Panel - Preview and Download -->
            <div class="space-y-6">
                
                <!-- QR Code Preview -->
                <div class="card-gradient rounded-xl p-6 shadow-xl">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold text-gray-800">
                            <i class="fas fa-eye mr-2 text-purple-600"></i>
                            Preview
                        </h3>
                        <div class="flex items-center space-x-2">
                            <div class="badge badge-sm" :class="qrData ? 'badge-success' : 'badge-warning'">
                                <i :class="qrData ? 'fas fa-check' : 'fas fa-clock'" class="mr-1"></i>
                                <span x-text="qrData ? 'Ready' : 'Generating...'"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="qr-container">
                        <div x-show="loading" class="text-center">
                            <div class="loading-spinner mx-auto mb-4"></div>
                            <p class="text-gray-600">Generating QR Code...</p>
                        </div>
                        
                        <div x-show="!loading && qrData" class="text-center">
                            <div id="qrPreview"></div>
                        </div>
                        
                        <div x-show="!loading && !qrData" class="text-center text-gray-500">
                            <i class="fas fa-qrcode text-6xl mb-4 opacity-30"></i>
                            <p>Enter content to generate QR code</p>
                        </div>
                    </div>
                </div>
                
                <!-- Download Options -->
                <div class="card-gradient rounded-xl p-6 shadow-xl" x-show="qrData">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-download mr-2 text-purple-600"></i>
                        Download Options
                    </h3>
                    
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <button 
                            class="download-btn text-white py-3 px-4 rounded-lg font-medium flex items-center justify-center space-x-2 hover:shadow-lg transition-all"
                            @click="downloadQR('png')"
                        >
                            <i class="fas fa-image"></i>
                            <span>PNG Image</span>
                        </button>
                        
                        <button 
                            class="download-btn text-white py-3 px-4 rounded-lg font-medium flex items-center justify-center space-x-2 hover:shadow-lg transition-all"
                            @click="downloadQR('svg')"
                        >
                            <i class="fas fa-vector-square"></i>
                            <span>SVG Vector</span>
                        </button>
                    </div>
                    
                    <!-- File name input -->
                    <div class="mt-4">
                        <label for="fileName" class="block text-sm font-medium text-gray-700 mb-2">File Name</label>
                        <input 
                            id="fileName"
                            type="text" 
                            class="w-full p-3 border-2 border-purple-200 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                            placeholder="qr-code"
                            x-model="fileName"
                        >
                    </div>
                </div>
                
                <!-- QR Code Info -->
                <div class="card-gradient rounded-xl p-6 shadow-xl" x-show="qrData">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-info-circle mr-2 text-purple-600"></i>
                        QR Code Information
                    </h3>
                    
                    <div class="space-y-3">
                        <div class="flex justify-between items-center py-2 border-b border-purple-100">
                            <span class="text-gray-600 font-medium">Type:</span>
                            <span class="text-gray-800 capitalize" x-text="selectedType"></span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-purple-100">
                            <span class="text-gray-600 font-medium">Size:</span>
                            <span class="text-gray-800" x-text="size + 'x' + size + ' pixels'"></span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-purple-100">
                            <span class="text-gray-600 font-medium">Error Correction:</span>
                            <span class="text-gray-800" x-text="getErrorCorrectionLabel(errorCorrection)"></span>
                        </div>
                        <div class="flex justify-between items-center py-2">
                            <span class="text-gray-600 font-medium">Data Length:</span>
                            <span class="text-gray-800" x-text="getContentLength() + ' characters'"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Features Section -->
        <div class="mt-12">
            <h2 class="text-3xl font-bold text-center text-white mb-8">âœ¨ Features</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="feature-card bg-white/90 backdrop-blur-sm rounded-xl p-6 text-center shadow-xl">
                    <div class="text-4xl mb-4">ðŸŽ¯</div>
                    <h3 class="text-lg font-bold text-gray-800 mb-2">Multiple Types</h3>
                    <p class="text-gray-600 text-sm">Support for URLs, text, email, SMS, WiFi, vCard, and phone numbers</p>
                </div>
                
                <div class="feature-card bg-white/90 backdrop-blur-sm rounded-xl p-6 text-center shadow-xl">
                    <div class="text-4xl mb-4">ðŸŽ¨</div>
                    <h3 class="text-lg font-bold text-gray-800 mb-2">Customizable</h3>
                    <p class="text-gray-600 text-sm">Change colors, size, and error correction levels with color presets</p>
                </div>
                
                <div class="feature-card bg-white/90 backdrop-blur-sm rounded-xl p-6 text-center shadow-xl">
                    <div class="text-4xl mb-4">ðŸ’¾</div>
                    <h3 class="text-lg font-bold text-gray-800 mb-2">Multiple Formats</h3>
                    <p class="text-gray-600 text-sm">Download as PNG image or SVG vector format</p>
                </div>
                
                <div class="feature-card bg-white/90 backdrop-blur-sm rounded-xl p-6 text-center shadow-xl">
                    <div class="text-4xl mb-4">âš¡</div>
                    <h3 class="text-lg font-bold text-gray-800 mb-2">Real-time</h3>
                    <p class="text-gray-600 text-sm">Instant preview as you type with live updates</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div 
        id="toast" 
        class="toast-notification"
        :class="toastType"
        x-show="showToast"
        x-transition:enter="transition ease-out duration-300"
        x-transition:enter-start="opacity-0 transform translate-x-full"
        x-transition:enter-end="opacity-100 transform translate-x-0"
        x-transition:leave="transition ease-in duration-300"
        x-transition:leave-start="opacity-100 transform translate-x-0"
        x-transition:leave-end="opacity-0 transform translate-x-full"
    >
        <div class="flex items-center space-x-2">
            <i :class="toastType === 'toast-success' ? 'fas fa-check' : 'fas fa-exclamation-triangle'"></i>
            <span x-text="toastMessage"></span>
        </div>
    </div>

    <script src="../../assets/js/utils.js"></script>
    <script>
        function qrGenerator() {
            return {
                // State
                selectedType: 'text',
                loading: false,
                qrData: null,
                qrCode: null,
                showToast: false,
                toastMessage: '',
                toastType: 'toast-success',
                showWifiPassword: false,
                
                // Configuration
                size: 256,
                errorCorrection: 'M',
                foregroundColor: '#000000',
                backgroundColor: '#ffffff',
                fileName: 'qr-code',
                
                // Content data for different types
                content: {
                    text: '',
                    email: '',
                    subject: '',
                    body: '',
                    phone: '',
                    smsNumber: '',
                    smsMessage: '',
                    wifi: {
                        ssid: '',
                        password: '',
                        encryption: 'WPA',
                        hidden: false
                    },
                    vcard: {
                        firstName: '',
                        lastName: '',
                        organization: '',
                        title: '',
                        phone: '',
                        email: '',
                        website: ''
                    }
                },
                
                // QR Type definitions
                qrTypes: [
                    { id: 'text', name: 'Text', icon: 'ðŸ“' },
                    { id: 'url', name: 'URL', icon: 'ðŸ”—' },
                    { id: 'email', name: 'Email', icon: 'ðŸ“§' },
                    { id: 'phone', name: 'Phone', icon: 'ðŸ“ž' },
                    { id: 'sms', name: 'SMS', icon: 'ðŸ’¬' },
                    { id: 'wifi', name: 'WiFi', icon: 'ðŸ“¶' },
                    { id: 'vcard', name: 'vCard', icon: 'ðŸ‘¤' }
                ],
                
                // Color presets
                colorPresets: [
                    { name: 'Classic', fg: '#000000', bg: '#ffffff' },
                    { name: 'Blue', fg: '#1e40af', bg: '#eff6ff' },
                    { name: 'Purple', fg: '#7c3aed', bg: '#f3e8ff' },
                    { name: 'Green', fg: '#059669', bg: '#ecfdf5' },
                    { name: 'Red', fg: '#dc2626', bg: '#fef2f2' },
                    { name: 'Orange', fg: '#ea580c', bg: '#fff7ed' },
                    { name: 'Dark', fg: '#ffffff', bg: '#111827' },
                    { name: 'Gold', fg: '#d97706', bg: '#fffbeb' }
                ],
                
                init() {
                    // Generate initial QR code with sample text
                    this.content.text = 'Hello, World!';
                    this.generateQR();
                },
                
                selectType(type) {
                    this.selectedType = type;
                    this.generateQR();
                },
                
                async generateQR() {
                    const contentString = this.getContentString();
                    
                    if (!contentString.trim()) {
                        this.qrData = null;
                        const qrContainer = document.getElementById('qrPreview');
                        if (qrContainer) {
                            qrContainer.innerHTML = '';
                        }
                        return;
                    }
                    
                    this.loading = true;
                    
                    // Small delay to show loading state
                    setTimeout(() => {
                        try {
                            const qrContainer = document.getElementById('qrPreview');
                            if (!qrContainer) {
                                console.error('QR container not found');
                                this.loading = false;
                                return;
                            }
                            
                            // Clear previous QR code
                            qrContainer.innerHTML = '';
                            
                            // Map error correction levels
                            let correctLevel = QRCode.CorrectLevel.M; // Default
                            try {
                                const errorCorrectionMap = {
                                    'L': QRCode.CorrectLevel.L,
                                    'M': QRCode.CorrectLevel.M,
                                    'Q': QRCode.CorrectLevel.Q,
                                    'H': QRCode.CorrectLevel.H
                                };
                                correctLevel = errorCorrectionMap[this.errorCorrection] || QRCode.CorrectLevel.M;
                            } catch (e) {
                                // Fallback if CorrectLevel is not available
                                correctLevel = 0; // L level
                                if (this.errorCorrection === 'M') correctLevel = 1;
                                if (this.errorCorrection === 'Q') correctLevel = 2;
                                if (this.errorCorrection === 'H') correctLevel = 3;
                            }
                            
                            // Create new QR code
                            this.qrCode = new QRCode(qrContainer, {
                                text: contentString,
                                width: this.size,
                                height: this.size,
                                colorDark: this.foregroundColor,
                                colorLight: this.backgroundColor,
                                correctLevel: correctLevel
                            });
                            
                            this.qrData = true; // Set to true to show download options
                            this.loading = false;
                        } catch (error) {
                            console.error('QR generation error:', error);
                            this.showToastMessage('Error generating QR code', 'toast-error');
                            this.qrData = null;
                            this.loading = false;
                        }
                    }, 100);
                },
                
                getContentString() {
                    switch (this.selectedType) {
                        case 'text':
                            return this.content.text;
                            
                        case 'url':
                            let url = this.content.text.trim();
                            if (url && !url.startsWith('http://') && !url.startsWith('https://')) {
                                url = 'https://' + url;
                            }
                            return url;
                            
                        case 'email':
                            let emailStr = `mailto:${this.content.email}`;
                            const params = [];
                            if (this.content.subject) params.push(`subject=${encodeURIComponent(this.content.subject)}`);
                            if (this.content.body) params.push(`body=${encodeURIComponent(this.content.body)}`);
                            if (params.length > 0) emailStr += '?' + params.join('&');
                            return emailStr;
                            
                        case 'phone':
                            return `tel:${this.content.phone}`;
                            
                        case 'sms':
                            let smsStr = `sms:${this.content.smsNumber}`;
                            if (this.content.smsMessage) {
                                smsStr += `?body=${encodeURIComponent(this.content.smsMessage)}`;
                            }
                            return smsStr;
                            
                        case 'wifi':
                            const wifi = this.content.wifi;
                            let wifiStr = `WIFI:T:${wifi.encryption};S:${wifi.ssid};`;
                            if (wifi.password && wifi.encryption !== 'nopass') {
                                wifiStr += `P:${wifi.password};`;
                            }
                            if (wifi.hidden) {
                                wifiStr += 'H:true;';
                            }
                            wifiStr += ';';
                            return wifiStr;
                            
                        case 'vcard':
                            const vcard = this.content.vcard;
                            let vcardStr = 'BEGIN:VCARD\nVERSION:3.0\n';
                            if (vcard.firstName || vcard.lastName) {
                                vcardStr += `FN:${vcard.firstName} ${vcard.lastName}\n`;
                                vcardStr += `N:${vcard.lastName};${vcard.firstName};;;\n`;
                            }
                            if (vcard.organization) vcardStr += `ORG:${vcard.organization}\n`;
                            if (vcard.title) vcardStr += `TITLE:${vcard.title}\n`;
                            if (vcard.phone) vcardStr += `TEL:${vcard.phone}\n`;
                            if (vcard.email) vcardStr += `EMAIL:${vcard.email}\n`;
                            if (vcard.website) vcardStr += `URL:${vcard.website}\n`;
                            vcardStr += 'END:VCARD';
                            return vcardStr;
                            
                        default:
                            return '';
                    }
                },
                
                getContentLength() {
                    return this.getContentString().length;
                },
                
                getErrorCorrectionLabel(level) {
                    const labels = {
                        'L': 'Low (7%)',
                        'M': 'Medium (15%)',
                        'Q': 'Quartile (25%)',
                        'H': 'High (30%)'
                    };
                    return labels[level] || 'Unknown';
                },
                
                applyColorPreset(preset) {
                    this.foregroundColor = preset.fg;
                    this.backgroundColor = preset.bg;
                    this.generateQR();
                },
                
                async downloadQR(format) {
                    if (!this.qrData || !this.qrCode) {
                        this.showToastMessage('No QR code to download', 'toast-error');
                        return;
                    }
                    
                    try {
                        const qrContainer = document.getElementById('qrPreview');
                        if (!qrContainer) {
                            this.showToastMessage('QR code not found', 'toast-error');
                            return;
                        }
                        
                        if (format === 'png') {
                            // Download PNG
                            const canvas = qrContainer.querySelector('canvas');
                            if (canvas) {
                                const link = document.createElement('a');
                                link.download = `${this.fileName}.png`;
                                link.href = canvas.toDataURL('image/png');
                                link.click();
                            } else {
                                // Fallback: try to get image
                                const img = qrContainer.querySelector('img');
                                if (img) {
                                    const link = document.createElement('a');
                                    link.download = `${this.fileName}.png`;
                                    link.href = img.src;
                                    link.click();
                                } else {
                                    this.showToastMessage('Unable to download PNG', 'toast-error');
                                    return;
                                }
                            }
                        } else if (format === 'svg') {
                            // For SVG, we'll create a simple SVG version
                            const canvas = qrContainer.querySelector('canvas');
                            if (canvas) {
                                // Convert canvas to SVG
                                const svgString = this.canvasToSVG(canvas);
                                const blob = new Blob([svgString], { type: 'image/svg+xml' });
                                const url = URL.createObjectURL(blob);
                                const link = document.createElement('a');
                                link.download = `${this.fileName}.svg`;
                                link.href = url;
                                link.click();
                                URL.revokeObjectURL(url);
                            } else {
                                this.showToastMessage('Unable to download SVG', 'toast-error');
                                return;
                            }
                        }
                        
                        this.showToastMessage(`QR code downloaded as ${format.toUpperCase()}`, 'toast-success');
                    } catch (error) {
                        console.error('Download error:', error);
                        this.showToastMessage('Error downloading QR code', 'toast-error');
                    }
                },
                
                canvasToSVG(canvas) {
                    const ctx = canvas.getContext('2d');
                    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    const data = imageData.data;
                    
                    let svgString = `<svg xmlns="http://www.w3.org/2000/svg" width="${canvas.width}" height="${canvas.height}" viewBox="0 0 ${canvas.width} ${canvas.height}">`;
                    svgString += `<rect width="100%" height="100%" fill="${this.backgroundColor}"/>`;
                    
                    // Convert pixel data to SVG rectangles (optimized for QR codes)
                    const blockSize = Math.floor(canvas.width / 25); // Assume typical QR code has about 25x25 modules
                    
                    for (let y = 0; y < canvas.height; y += blockSize) {
                        for (let x = 0; x < canvas.width; x += blockSize) {
                            const i = (y * canvas.width + x) * 4;
                            const r = data[i];
                            const g = data[i + 1];
                            const b = data[i + 2];
                            const a = data[i + 3];
                            
                            // If pixel is dark (not background color), add a rectangle
                            if (a > 0 && (r < 128 || g < 128 || b < 128)) {
                                svgString += `<rect x="${x}" y="${y}" width="${blockSize}" height="${blockSize}" fill="${this.foregroundColor}"/>`;
                            }
                        }
                    }
                    
                    svgString += '</svg>';
                    return svgString;
                },
                
                showToastMessage(message, type = 'toast-success') {
                    this.toastMessage = message;
                    this.toastType = type;
                    this.showToast = true;
                    
                    setTimeout(() => {
                        this.showToast = false;
                    }, 3000);
                }
            }
        }
    </script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    screens: {
                        'xs': '375px',
                    }
                }
            }
        }
    </script>
</body>
</html>
